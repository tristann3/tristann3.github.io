<!DOCTYPE html>
<html>
	<head>
		<title>Color Fun</title>
			<style>
				.swatch {
					width: 100px;
					height: 100px;
				}
			
				main {
					width: 80%;
					margin: auto;
				}
			</style>
      <link rel="stylesheet" type="text/css" href="cotton-candy.css">
      <link rel="stylesheet" type="text/css" href="styles.css">
	</head>
	<body>

		<!-- Base Styles - Set the base styles for the page -->

		<main>

			<!-- navbar - Style the navbar -->
      <nav class="nav-center" style="position: fixed;top: 0px;left: 0px;right: 0px;background-color: black;padding: 20px;color: #fff!important;">
        <ul>
          <li class="list-head">
            <a href="#">Color.com</a>
          </li>
          <li class="list-item">
						<a href="#about">About</a>
          </li>
          <li class="list-item">
						<a href="#popular">Popular</a>
          </li>
          <li class="list-item">
						<a href="#swatches">Swatches</a>
          </li>
          <li class="list-item">
						<a href="#cart">Order</a>
          </li>
          <li class="list-item">
						<a href="#contact">Contact</a>
          </li>
        </ul>
      </nav>
      <nav class="nav-center"style="padding-top: 150px;">
        <h1 class="header nav-center"><ticker-tape>...Color.com is awesome...</ticker-tape></h1>
        <!-- <h1 class="header nav-center">...Color.com is awesome...</h1> -->
      </nav>

			<!-- section about --->
			<section id="about">
				<header>
					<h1 class ="content header-main">What is color?</h1>
				</header>
				<p class ="content"><strong>Color</strong> (American English), or colour (Commonwealth English), is the characteristic of visual perception described through color categories, with names such as red, orange, yellow, green, blue, or purple. This perception of color derives from the stimulation of photoreceptor cells (in particular cone cells in the human eye and other vertebrate eyes) by electromagnetic radiation (in the visible spectrum in the case of humans).</p>
				<p class ="content">Color is really important for making great <abbr title="Cascading Style Sheets">CSS</abbr> styles. <a href="#">Color.com is the most amazing place to get your colors.</a></p>
			</section>


			
			<!-- Section Color Cards - This section contains three cards Style these -->
      <section id="popular">
        <div class="card">
          <img src="images/600px-64_365_Color_Macro.jpg">
          <p class="content">Colored Pencils</p>
        </div>

        <div class="card">
          <img src="images/600px-Nasir-al_molk.jpg">
          <p class="content">Color effectâ€”sunlight shining through stained glass onto carpet (Nasir ol Molk Mosque located in Shiraz, Iran)</p>
        </div>

        <div class="card">
          <img src="images/600px-Chubb_Illusion.png">
          <p class="content">Colors can appear different depending on their surrounding colors and shapes. The two small squares have exactly the same color, but the right one looks slightly darker, the Chubb illusion.</p>
        </div>
      </section>


      <div class="shopping">
        <!-- Section Color Swatches - This section contains -->
        <section id="swatches">
          <header class="header"id="swatches-head">
            <h1>STOP!!</h1>
            <p class='content'>As you can see, the font color of the website is pink. Try to find the matching color below for a surprise, good luck!</p>
          </header>
          <div class="swatches">
            <!-- div.swatch -->
          </div>
        </section>

        <section id="cart">
          <header class="header nav-center">
            <h1>Cart</h1>
          </header>

          <ul class="content" id="items">
            <!-- Items here -->
          </ul>
    
          <div class="header nav-center"id="total">
            <!-- Total here -->
          </div>
        </section>
      </div>
		</main>
    <!-- Footer -->
    <section class="footer">
      <footer>
        <ul>
          <!-- Contact form -->
          <section id="contact">
            <header>
              <h1>Contact</h1>
            </header>
            <div>
              <form class="contact-form">

                <div class="contact-one">
                  <label>
                    Name
                    <input type="text">
                  </label>
  
                  <label>
                    Subject
                    <input type="text">
                  </label>
  
                  <label>
                    Message
                  </label>
                  <textarea></textarea>
                </div>
                
                <div>
                  <label class="input-check">
                    Sign up for the newsletter
                    <input type="checkbox">
                    <span class="checkmark"></span>
                  </label>
  
                  <label class="input-radio">
                    <input type="radio" name="radio">
                    <span class="radio-button"></span>
                    Artist
                  </label>
  
                  <label class="input-radio">
                    <input  type="radio" name="radio">
                    <span class="radio-button"></span>
                    Designer
                  </label>
  
                  <label class="input-radio">
                    <input  type="radio" name="radio">
                    <span class="radio-button"></span>
                    Enthusiast
                  </label>
                  <button class="confirm">Submit</button>
                  
                </div>
                

              </form>
            </div>
          </section>
        </ul>
      </footer>
    </section>
    <script src="./confetti.js"></script>
    <script src="./ticker-tape.js"></script>
		<script>
      
			

			// All 100 color swatches has a CSS custom property assigne to it. 
			// You can use this color each swatch with a unique color. 

			// --color-sample-0 : red
			// --color-sample-1 : green
			// ...
			// --color-sample-99 : blue

			// make some swatches 
			const swatchCount = 100
			for (let i = 0; i < swatchCount; i += 1) {
				// 230, 254
        const swatch = `
				<div 
          style="background-color: rgb(${255}, ${230-i}, ${254-i});"" 
					class="swatch add-to-cart color-${i}" 
					data-color="Color ${i}" 
					data-price="${(Math.random() * 10).toFixed(2)}"></div>`
				document.querySelector('.swatches').innerHTML += swatch
			}

      const addForm = document.getElementById('add-form')
      const inputName = document.getElementById('name')
      const inputPrice = document.getElementById('price')
      const itemsList = document.getElementById('items')
      const divTotal = document.getElementById('total')

			function handleClicks(e) {
				if (e.target.matches('.swatch')) {
					const color = e.target.dataset.color
					const price = e.target.dataset.price
					addToCart(color, price)
          // change after add to cart finishes
				}

			}
			
			document.querySelector('body').addEventListener('click', handleClicks)

      const cart = []

      document.querySelector('body').addEventListener('submit', function(e){
        e.preventDefault()
        const name = inputName.value
        const price = inputPrice.value
        // addToCart(name, price)
        (async () => {
          await addToCart(name, price)
        })();
        // addToCart(name, price)
        showCart()
      })

			document.querySelector('body').addEventListener('click', function(e) {
        if (e.target && e.target.classList.contains('remove')) {
          console.log(e.target.dataset.name)
          removeFromCart(e.target.dataset.name)
        } else if (e.target && e.target.classList.contains('add-one')) {
          addToCart(e.target.dataset.name)
        } else if (e.target && e.target.classList.contains('remove-one')) {
          removeFromCart(e.target.dataset.name, 1)
        }
			})

      document.querySelector('body').addEventListener('input', function(e) {
        if (e.target.matches('.update')) {
          const qty = parseInt(e.target.value)
          const name = e.target.dataset.name
          updateCart(name, qty)
        }
      })

      function addToCart(name, price) {
        // to start
        if (name.includes("Color 44")){
          const start = () => {
            setTimeout(function() {
              confetti.start();
            }, 1000);
          }
          // to stop
          const stop = () => {
            setTimeout(function() {
              confetti.start();
            }, 5000);
          }
          const box =document.querySelector(`.swatch-price-${name.slice(-2)}`);
          console.log(box)
          console.log((`.swatch-price-${name.slice(-2)}`))
          start();
          stop();
        }
        else {
          document.querySelector(`.color-${name.slice(-2)}`).style.backgroundColor = "red";

        }
        for (let i = 0; i < cart.length; i += 1) {
          if (cart[i].name === name) {
            cart[i].qty += 1
            showCart()
            // maybe add style in here
            return true
          }
        }
        cart.push({ name, price, qty: 1})
        showCart()
        // also here
      }

      function removeFromCart(name, qty = 0) {
        console.log(name, qty)
        for (let i = 0; i < cart.length; i += 1) {
          if (cart[i].name === name) {
            if (qty) {
              let newQty = cart[i].qty - qty
              if (newQty > 0) {
                cart[i].qty = newQty
              } else {
                cart.splice(i, 1)
              }
            } else {
              cart.splice(i, 1)
            }
          }
        }

        showCart()
      }

      function showCart() {
        let str = ''
        for (let i = 0; i < cart.length; i += 1) {
					// Shopping cart list item! 
          str += `<li>
            <span class = "content swatch-price-${cart[i].name.slice(-2)}">
							<span >${cart[i].name}</span>
							<span >${cart[i].price}</span> 
							<span >each x</span>
							<span >${cart[i].qty}</span> 
							<span > = </span>  
							<span class="price">${(cart[i].qty * cart[i].price).toFixed(2)}</span>
						</span>
            
						<span class = "input-fields">
							<input class="update input" data-name="${cart[i].name}" type="number" value="${cart[i].qty}">
							<button class="add-one input" data-name="${cart[i].name}"> + </button>
							<button class="remove-one input" data-name="${cart[i].name}"> - </button>
							<button class="remove input" data-name="${cart[i].name}">remove</button>
						</span>
          </li>`
        }
        itemsList.innerHTML = str
        divTotal.innerHTML = getTotal()
      }

      function getTotal() {
        let total = 0
        for (let i = 0; i < cart.length; i += 1) {
          total += cart[i].price * cart[i].qty
        }
        return total.toFixed(2)
      }

      function updateCart(name, qty) {
        for (let i = 0; i < cart.length; i += 1) {
          if (cart[i].name === name) {
            cart[i].qty = qty
            showCart()
            return true
          }
        }
        return false
      }

      showCart()
      getTotal()

		</script>
		
	</body>
</html>